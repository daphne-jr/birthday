"use strict";(self.webpackChunkbirthday=self.webpackChunkbirthday||[]).push([[642],{2633:(e,t,n)=>{n.d(t,{cn:()=>E,KO:()=>P});var r=n(7294);const o=Symbol(),i=e=>!!e[o],s=e=>{var t,n;null==(n=(t=e[o]).c)||n.call(t)},c=(e,t)=>{const n=e[o].o,r=t[o].o;return n===r||e===r||i(n)&&c(n,t)},a=e=>{const t={o:e,c:null},n=new Promise((n=>{t.c=()=>{t.c=null,n()},e.then(t.c,t.c)}));return n[o]=t,n};var l=Object.defineProperty,u=Object.defineProperties,d=Object.getOwnPropertyDescriptors,f=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,v=(e,t,n)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const h=e=>"init"in e,b=e=>{const t=new WeakMap,n=new WeakMap,r=new Map;let l,b;if(l=new Set,b=new Set,e)for(const[n,r]of e){const e={v:r,r:0,d:new Map};Object.freeze(e),h(n)||console.warn("Found initial value for derived atom which can cause unexpected behavior",n),t.set(n,e)}const g=new WeakMap,m=new WeakMap,y=e=>{let t=m.get(e);return t||(t=new Map,m.set(e,t)),t},E=(e,n)=>{if(e){const t=y(e);let r=t.get(n);return r||(r=E(e.p,n),r&&("p"in r&&r.p.then((()=>t.delete(n))),t.set(n,r))),r}return t.get(n)},O=(e,n,o)=>{if(Object.freeze(o),e)y(e).set(n,o);else{const e=t.get(n);t.set(n,o),r.has(n)||r.set(n,e)}},j=(e,t=new Map,n)=>{if(!n)return t;const r=new Map;let o=!1;return n.forEach((n=>{var i;const s=(null==(i=E(e,n))?void 0:i.r)||0;r.set(n,s),t.get(n)!==s&&(o=!0)})),t.size!==r.size||o?r:t},P=(e,t,n,r,o)=>{const i=E(e,t);if(i){if(o&&(!("p"in i)||!c(i.p,o)))return i;"p"in i&&s(i.p)}const a={v:n,r:(null==i?void 0:i.r)||0,d:j(e,null==i?void 0:i.d,r)};return i&&"v"in i&&Object.is(i.v,n)?a.d===i.d||a.d.size===i.d.size&&Array.from(a.d.keys()).every((e=>i.d.has(e)))||Promise.resolve().then((()=>{I(e)})):(++a.r,a.d.has(t)&&(a.d=new Map(a.d).set(t,a.r))),O(e,t,a),a},M=(e,t,n,r,o)=>{const i=E(e,t);if(i){if(o&&(!("p"in i)||!c(i.p,o)))return i;"p"in i&&s(i.p)}const a={e:n,r:(null==i?void 0:i.r)||0,d:j(e,null==i?void 0:i.d,r)};return O(e,t,a),a},k=(e,t,n,r)=>{const o=E(e,t);if(o&&"p"in o){if(c(o.p,n))return o;s(o.p)}((e,t,n)=>{let r=g.get(t);r||(r=new Map,g.set(t,r)),n.then((()=>{r.get(e)===n&&(r.delete(e),r.size||g.delete(t))})),r.set(e,n)})(e,t,n);const i={p:n,r:(null==o?void 0:o.r)||0,d:j(e,null==o?void 0:o.d,r)};return O(e,t,i),i},S=(e,t,n,r)=>{if(n instanceof Promise){const o=a(n.then((n=>{P(e,t,n,r,o),I(e)})).catch((n=>{if(n instanceof Promise)return i(n)?n.then((()=>{z(e,t,!0)})):n;M(e,t,n,r,o),I(e)})));return k(e,t,o,r)}return P(e,t,n,r)},z=(e,t,r)=>{if(!r){const r=E(e,t);if(r){if(r.r!==r.i&&"p"in r&&r.p[o].c)return r;if(r.d.forEach(((r,o)=>{if(o!==t)if(n.has(o)){const t=E(e,o);t&&t.r===t.i&&z(e,o)}else z(e,o)})),Array.from(r.d).every((([t,n])=>{const r=E(e,t);return r&&"v"in r&&r.r===n})))return r}}const i=new Set;try{const n=t.read((n=>{i.add(n);const r=n===t?E(e,n):z(e,n);if(r){if("e"in r)throw r.e;if("p"in r)throw r.p;return r.v}if(h(n))return n.init;throw new Error("no atom init")}));return S(e,t,n,i)}catch(n){if(n instanceof Promise){const r=a(n);return k(e,t,r,i)}return M(e,t,n,i)}},C=(e,t)=>!t.l.size&&(!t.t.size||1===t.t.size&&t.t.has(e)),x=(e,t)=>{const r=n.get(t);null==r||r.t.forEach((n=>{n!==t&&(((e,t)=>{const n=E(e,t);if(n){const i=(r=((e,t)=>{for(var n in t||(t={}))p.call(t,n)&&v(e,n,t[n]);if(f)for(var n of f(t))w.call(t,n)&&v(e,n,t[n]);return e})({},n),o={i:n.r},u(r,d(o)));O(e,t,i)}else console.warn("[Bug] could not invalidate non existing atom",t);var r,o})(e,n),x(e,n))}))},A=(e,t,n)=>{let r=!0;const o=(t,n)=>{const r=z(e,t);if("e"in r)throw r.e;if("p"in r){if(null==n?void 0:n.unstable_promise)return r.p.then((()=>o(t,n)));throw console.info("Reading pending atom state in write operation. We throw a promise for now.",t),r.p}if("v"in r)return r.v;throw console.warn("[Bug] no value found while reading atom in write operation. This is probably a bug.",t),new Error("no value found")},i=t.write(o,((n,o)=>{let i;if(n===t){if(!h(n))throw new Error("atom not writable");const t=(e=>{const t=new Set,n=g.get(e);return n&&(g.delete(e),n.forEach(((e,n)=>{s(e),t.add(n)}))),t})(n);t.forEach((t=>{t!==e&&S(t,n,o)})),S(e,n,o),x(e,n)}else i=A(e,n,o);return r||I(e),i}),n);return r=!1,e=void 0,i},W=(e,t,n)=>{const r=A(n,e,t);return I(n),r},R=(e,t)=>{const r={t:new Set(t&&[t]),l:new Set};if(n.set(e,r),b.add(e),z(void 0,e).d.forEach(((t,r)=>{const o=n.get(r);o?o.t.add(e):r!==e&&R(r,e)})),(e=>!!e.write)(e)&&e.onMount){const t=t=>W(e,t),n=e.onMount(t);n&&(r.u=n)}return r},B=e=>{var t;const r=null==(t=n.get(e))?void 0:t.u;r&&r(),n.delete(e),b.delete(e);const o=E(void 0,e);o?o.d.forEach(((t,r)=>{if(r!==e){const t=n.get(r);t&&(t.t.delete(e),C(r,t)&&B(r))}})):console.warn("[Bug] could not find atom state to unmount",e)},D=(e,t,r)=>{const o=new Set(t.d.keys());null==r||r.forEach(((t,r)=>{if(o.has(r))return void o.delete(r);const i=n.get(r);i&&(i.t.delete(e),C(r,i)&&B(r))})),o.forEach((t=>{const r=n.get(t);r?r.t.add(e):n.has(e)&&R(t,e)}))},I=e=>{if(e)y(e).forEach(((r,o)=>{if(r!==t.get(o)){const t=n.get(o);null==t||t.l.forEach((t=>t(e)))}}));else{for(;r.size;){const e=Array.from(r);r.clear(),e.forEach((([e,t])=>{const r=E(void 0,e);r&&r.d!==(null==t?void 0:t.d)&&D(e,r,null==t?void 0:t.d);const o=n.get(e);null==o||o.l.forEach((e=>e()))}))}l.forEach((e=>e()))}};return{r:(e,t)=>z(t,e),w:W,c:(e,n)=>{n&&(e=>{y(e).forEach(((e,n)=>{const r=t.get(n);(e.r>((null==r?void 0:r.r)||0)||"v"in e&&e.r===(null==r?void 0:r.r)&&e.d!==(null==r?void 0:r.d))&&(t.set(n,e),e.d!==(null==r?void 0:r.d)&&D(n,e,null==r?void 0:r.d))}))})(n),I(void 0)},s:(e,t)=>{const r=(e=>{let t=n.get(e);return t||(t=R(e)),t})(e).l;return r.add(t),()=>{r.delete(t),(e=>{const t=n.get(e);t&&C(e,t)&&B(e)})(e)}},h:(e,t)=>{for(const[n,r]of e)h(n)&&(S(t,n,r),x(t,n));I(t)},n:e=>(l.add(e),()=>{l.delete(e)}),l:()=>b.values(),a:e=>t.get(e),m:e=>n.get(e)}},g=new Map,m=e=>{return g.has(e)||g.set(e,(0,r.createContext)({s:n?n(t).SECRET_INTERNAL_store:b(t)})),g.get(e);var t,n};Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let y=0;function E(e,t){const n="atom"+ ++y,r={toString:()=>n};return"function"==typeof e?r.read=e:(r.init=e,r.read=e=>e(r),r.write=(e,t,n)=>t(r,"function"==typeof n?n(e(r)):n)),t&&(r.write=t),r}function O(e,t){const n=m(t),{s:o}=(0,r.useContext)(n),i=(0,r.useCallback)((t=>{const n=o.r(e,t);if("e"in n)throw n.e;if("p"in n)throw n.p;if("v"in n)return n.v;throw new Error("no atom value")}),[o,e]),[[s,c,a],l]=(0,r.useReducer)((0,r.useCallback)(((t,n)=>{const r=i(n);return Object.is(t[1],r)&&t[2]===e?t:[n,r,e]}),[i,e]),void 0,(()=>{const t=void 0;return[t,i(t),e]}));return a!==e&&l(void 0),(0,r.useEffect)((()=>{const t=o.s(e,l);return l(void 0),t}),[o,e]),(0,r.useEffect)((()=>{o.c(e,s)})),(0,r.useDebugValue)(c),c}function j(e,t){const n=m(t),{s:o,w:i}=(0,r.useContext)(n);return(0,r.useCallback)((t=>{const n=n=>o.w(e,t,n);return i?i(n):n()}),[o,i,e])}function P(e,t){return"scope"in e&&(console.warn("atom.scope is deprecated. Please do useAtom(atom, scope) instead."),t=e.scope),[O(e,t),j(e,t)]}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhdGljL2pzL25wbS5qb3RhaV8wZGNkNjk0ZGQ5N2U2MzFkOGYwZC5qcyIsIm1hcHBpbmdzIjoiNElBRUEsTUFBTUEsRUFBbUJDLFNBQ25CQyxFQUFxQkMsS0FBY0EsRUFBUUgsR0FFM0NJLEVBQXlCQyxJQUM3QixJQUFJQyxFQUFJQyxFQUM2QyxPQUFwREEsR0FBTUQsRUFBS0QsRUFBZ0JMLElBQW1CUSxJQUFzQkQsRUFBR0UsS0FBS0gsSUFFekVJLEVBQXlCLENBQUNDLEVBQW9CQyxLQUNsRCxNQUFNQyxFQUFxQkYsRUFBbUJYLEdBQWtCYyxFQUMxREMsRUFBcUJILEVBQW1CWixHQUFrQmMsRUFDaEUsT0FBT0QsSUFBdUJFLEdBQXNCSixJQUF1QkksR0FBc0JiLEVBQWtCVyxJQUF1QkgsRUFBdUJHLEVBQW9CRCxJQUVqTEksRUFBeUJiLElBQzdCLE1BQU1jLEVBQWlCLENBQ3JCSCxFQUFHWCxFQUNISyxFQUFHLE1BRUNILEVBQWtCLElBQUlhLFNBQVNDLElBQ25DRixFQUFlVCxFQUFJLEtBQ2pCUyxFQUFlVCxFQUFJLEtBQ25CVyxLQUVGaEIsRUFBUWlCLEtBQUtILEVBQWVULEVBQUdTLEVBQWVULE1BR2hELE9BREFILEVBQWdCTCxHQUFvQmlCLEVBQzdCWixHQUdULElBQUlnQixFQUFjQyxPQUFPQyxlQUNyQkMsRUFBZUYsT0FBT0csaUJBQ3RCQyxFQUFzQkosT0FBT0ssMEJBQzdCQyxFQUF3Qk4sT0FBT08sc0JBQy9CQyxFQUFpQlIsT0FBT1MsVUFBVUMsZUFDbENDLEVBQWlCWCxPQUFPUyxVQUFVRyxxQkFDbENDLEVBQW9CLENBQUNDLEVBQUtDLEVBQUtDLElBQVVELEtBQU9ELEVBQU1mLEVBQVllLEVBQUtDLEVBQUssQ0FBRUUsWUFBWSxFQUFNQyxjQUFjLEVBQU1DLFVBQVUsRUFBTUgsTUFBQUEsSUFBV0YsRUFBSUMsR0FBT0MsRUFhOUosTUFBTUksRUFBbUJDLEdBQVMsU0FBVUEsRUFVdENDLEVBQWVDLElBQ25CLE1BQU1DLEVBQXdDLElBQUlDLFFB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QU1xSCxHQUNuQnlCLEVBQVc5SSxFQUFNcUgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iaXJ0aGRheS8uL25vZGVfbW9kdWxlcy9qb3RhaS9lc20vaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ29udGV4dCwgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlUmVmLCBjcmVhdGVFbGVtZW50LCB1c2VEZWJ1Z1ZhbHVlLCB1c2VDb250ZXh0LCB1c2VDYWxsYmFjaywgdXNlUmVkdWNlciB9IGZyb20gJ3JlYWN0JztcblxuY29uc3QgU1VTUEVOU0VfUFJPTUlTRSA9IFN5bWJvbCgpO1xuY29uc3QgaXNTdXNwZW5zZVByb21pc2UgPSAocHJvbWlzZSkgPT4gISFwcm9taXNlW1NVU1BFTlNFX1BST01JU0VdO1xuY29uc3QgaXNTdXNwZW5zZVByb21pc2VBbHJlYWR5Q2FuY2VsbGVkID0gKHN1c3BlbnNlUHJvbWlzZSkgPT4gIXN1c3BlbnNlUHJvbWlzZVtTVVNQRU5TRV9QUk9NSVNFXS5jO1xuY29uc3QgY2FuY2VsU3VzcGVuc2VQcm9taXNlID0gKHN1c3BlbnNlUHJvbWlzZSkgPT4ge1xuICB2YXIgX2EsIF9iO1xuICAoX2IgPSAoX2EgPSBzdXNwZW5zZVByb21pc2VbU1VTUEVOU0VfUFJPTUlTRV0pLmMpID09IG51bGwgPyB2b2lkIDAgOiBfYi5jYWxsKF9hKTtcbn07XG5jb25zdCBpc0VxdWFsU3VzcGVuc2VQcm9taXNlID0gKG9sZFN1c3BlbnNlUHJvbWlzZSwgbmV3U3VzcGVuc2VQcm9taXNlKSA9PiB7XG4gIGNvbnN0IG9sZE9yaWdpbmFsUHJvbWlzZSA9IG9sZFN1c3BlbnNlUHJvbWlzZVtTVVNQRU5TRV9QUk9NSVNFXS5vO1xuICBjb25zdCBuZXdPcmlnaW5hbFByb21pc2UgPSBuZXdTdXNwZW5zZVByb21pc2VbU1VTUEVOU0VfUFJPTUlTRV0ubztcbiAgcmV0dXJuIG9sZE9yaWdpbmFsUHJvbWlzZSA9PT0gbmV3T3JpZ2luYWxQcm9taXNlIHx8IG9sZFN1c3BlbnNlUHJvbWlzZSA9PT0gbmV3T3JpZ2luYWxQcm9taXNlIHx8IGlzU3VzcGVuc2VQcm9taXNlKG9sZE9yaWdpbmFsUHJvbWlzZSkgJiYgaXNFcXVhbFN1c3BlbnNlUHJvbWlzZShvbGRPcmlnaW5hbFByb21pc2UsIG5ld1N1c3BlbnNlUHJvbWlzZSk7XG59O1xuY29uc3QgY3JlYXRlU3VzcGVuc2VQcm9taXNlID0gKHByb21pc2UpID0+IHtcbiAgY29uc3Qgb2JqZWN0VG9BdHRhY2ggPSB7XG4gICAgbzogcHJvbWlzZSxcbiAgICBjOiBudWxsXG4gIH07XG4gIGNvbnN0IHN1c3BlbnNlUHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgb2JqZWN0VG9BdHRhY2guYyA9ICgpID0+IHtcbiAgICAgIG9iamVjdFRvQXR0YWNoLmMgPSBudWxsO1xuICAgICAgcmVzb2x2ZSgpO1xuICAgIH07XG4gICAgcHJvbWlzZS50aGVuKG9iamVjdFRvQXR0YWNoLmMsIG9iamVjdFRvQXR0YWNoLmMpO1xuICB9KTtcbiAgc3VzcGVuc2VQcm9taXNlW1NVU1BFTlNFX1BST01JU0VdID0gb2JqZWN0VG9BdHRhY2g7XG4gIHJldHVybiBzdXNwZW5zZVByb21pc2U7XG59O1xuXG52YXIgX19kZWZQcm9wJDEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG52YXIgX19kZWZQcm9wcyQxID0gT2JqZWN0LmRlZmluZVByb3BlcnRpZXM7XG52YXIgX19nZXRPd25Qcm9wRGVzY3MkMSA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzO1xudmFyIF9fZ2V0T3duUHJvcFN5bWJvbHMkMSA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG52YXIgX19oYXNPd25Qcm9wJDEgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xudmFyIF9fcHJvcElzRW51bSQxID0gT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcbnZhciBfX2RlZk5vcm1hbFByb3AkMSA9IChvYmosIGtleSwgdmFsdWUpID0+IGtleSBpbiBvYmogPyBfX2RlZlByb3AkMShvYmosIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlLCB2YWx1ZSB9KSA6IG9ialtrZXldID0gdmFsdWU7XG52YXIgX19zcHJlYWRWYWx1ZXMkMSA9IChhLCBiKSA9PiB7XG4gIGZvciAodmFyIHByb3AgaW4gYiB8fCAoYiA9IHt9KSlcbiAgICBpZiAoX19oYXNPd25Qcm9wJDEuY2FsbChiLCBwcm9wKSlcbiAgICAgIF9fZGVmTm9ybWFsUHJvcCQxKGEsIHByb3AsIGJbcHJvcF0pO1xuICBpZiAoX19nZXRPd25Qcm9wU3ltYm9scyQxKVxuICAgIGZvciAodmFyIHByb3Agb2YgX19nZXRPd25Qcm9wU3ltYm9scyQxKGIpKSB7XG4gICAgICBpZiAoX19wcm9wSXNFbnVtJDEuY2FsbChiLCBwcm9wKSlcbiAgICAgICAgX19kZWZOb3JtYWxQcm9wJDEoYSwgcHJvcCwgYltwcm9wXSk7XG4gICAgfVxuICByZXR1cm4gYTtcbn07XG52YXIgX19zcHJlYWRQcm9wcyQxID0gKGEsIGIpID0+IF9fZGVmUHJvcHMkMShhLCBfX2dldE93blByb3BEZXNjcyQxKGIpKTtcbmNvbnN0IGhhc0luaXRpYWxWYWx1ZSA9IChhdG9tKSA9PiBcImluaXRcIiBpbiBhdG9tO1xuY29uc3QgUkVBRF9BVE9NID0gXCJyXCI7XG5jb25zdCBXUklURV9BVE9NID0gXCJ3XCI7XG5jb25zdCBDT01NSVRfQVRPTSA9IFwiY1wiO1xuY29uc3QgU1VCU0NSSUJFX0FUT00gPSBcInNcIjtcbmNvbnN0IFJFU1RPUkVfQVRPTVMgPSBcImhcIjtcbmNvbnN0IERFVl9TVUJTQ1JJQkVfU1RBVEUgPSBcIm5cIjtcbmNvbnN0IERFVl9HRVRfTU9VTlRFRF9BVE9NUyA9IFwibFwiO1xuY29uc3QgREVWX0dFVF9BVE9NX1NUQVRFID0gXCJhXCI7XG5jb25zdCBERVZfR0VUX01PVU5URUQgPSBcIm1cIjtcbmNvbnN0IGNyZWF0ZVN0b3JlID0gKGluaXRpYWxWYWx1ZXMpID0+IHtcbiAgY29uc3QgY29tbWl0dGVkQXRvbVN0YXRlTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7XG4gIGNvbnN0IG1vdW50ZWRNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbiAgY29uc3QgcGVuZGluZ01hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIGxldCBzdGF0ZUxpc3RlbmVycztcbiAgbGV0IG1vdW50ZWRBdG9tcztcbiAgaWYgKChpbXBvcnQubWV0YS5lbnYgJiYgaW1wb3J0Lm1ldGEuZW52Lk1PREUpICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgIHN0YXRlTGlzdGVuZXJzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgICBtb3VudGVkQXRvbXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICB9XG4gIGlmIChpbml0aWFsVmFsdWVzKSB7XG4gICAgZm9yIChjb25zdCBbYXRvbSwgdmFsdWVdIG9mIGluaXRpYWxWYWx1ZXMpIHtcbiAgICAgIGNvbnN0IGF0b21TdGF0ZSA9IHsgdjogdmFsdWUsIHI6IDAsIGQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCkgfTtcbiAgICAgIGlmICgoaW1wb3J0Lm1ldGEuZW52ICYmIGltcG9ydC5tZXRhLmVudi5NT0RFKSAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgICAgT2JqZWN0LmZyZWV6ZShhdG9tU3RhdGUpO1xuICAgICAgICBpZiAoIWhhc0luaXRpYWxWYWx1ZShhdG9tKSkge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcIkZvdW5kIGluaXRpYWwgdmFsdWUgZm9yIGRlcml2ZWQgYXRvbSB3aGljaCBjYW4gY2F1c2UgdW5leHBlY3RlZCBiZWhhdmlvclwiLCBhdG9tKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29tbWl0dGVkQXRvbVN0YXRlTWFwLnNldChhdG9tLCBhdG9tU3RhdGUpO1xuICAgIH1cbiAgfVxuICBjb25zdCBzdXNwZW5zZVByb21pc2VDYWNoZU1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpO1xuICBjb25zdCBhZGRTdXNwZW5zZVByb21pc2VUb0NhY2hlID0gKHZlcnNpb24sIGF0b20sIHN1c3BlbnNlUHJvbWlzZSkgPT4ge1xuICAgIGxldCBjYWNoZSA9IHN1c3BlbnNlUHJvbWlzZUNhY2hlTWFwLmdldChhdG9tKTtcbiAgICBpZiAoIWNhY2hlKSB7XG4gICAgICBjYWNoZSA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gICAgICBzdXNwZW5zZVByb21pc2VDYWNoZU1hcC5zZXQoYXRvbSwgY2FjaGUpO1xuICAgIH1cbiAgICBzdXNwZW5zZVByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICBpZiAoY2FjaGUuZ2V0KHZlcnNpb24pID09PSBzdXNwZW5zZVByb21pc2UpIHtcbiAgICAgICAgY2FjaGUuZGVsZXRlKHZlcnNpb24pO1xuICAgICAgICBpZiAoIWNhY2hlLnNpemUpIHtcbiAgICAgICAgICBzdXNwZW5zZVByb21pc2VDYWNoZU1hcC5kZWxldGUoYXRvbSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICBjYWNoZS5zZXQodmVyc2lvbiwgc3VzcGVuc2VQcm9taXNlKTtcbiAgfTtcbiAgY29uc3QgY2FuY2VsQWxsU3VzcGVuc2VQcm9taXNlSW5DYWNoZSA9IChhdG9tKSA9PiB7XG4gICAgY29uc3QgdmVyc2lvblNldCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG4gICAgY29uc3QgY2FjaGUgPSBzdXNwZW5zZVByb21pc2VDYWNoZU1hcC5nZXQoYXRvbSk7XG4gICAgaWYgKGNhY2hlKSB7XG4gICAgICBzdXNwZW5zZVByb21pc2VDYWNoZU1hcC5kZWxldGUoYXRvbSk7XG4gICAgICBjYWNoZS5mb3JFYWNoKChzdXNwZW5zZVByb21pc2UsIHZlcnNpb24pID0+IHtcbiAgICAgICAgY2FuY2VsU3VzcGVuc2VQcm9taXNlKHN1c3BlbnNlUHJvbWlzZSk7XG4gICAgICAgIHZlcnNpb25TZXQuYWRkKHZlcnNpb24pO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB2ZXJzaW9uU2V0O1xuICB9O1xuICBjb25zdCB2ZXJzaW9uZWRBdG9tU3RhdGVNYXBNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbiAgY29uc3QgZ2V0VmVyc2lvbmVkQXRvbVN0YXRlTWFwID0gKHZlcnNpb24pID0+IHtcbiAgICBsZXQgdmVyc2lvbmVkQXRvbVN0YXRlTWFwID0gdmVyc2lvbmVkQXRvbVN0YXRlTWFwTWFwLmdldCh2ZXJzaW9uKTtcbiAgICBpZiAoIXZlcnNpb25lZEF0b21TdGF0ZU1hcCkge1xuICAgICAgdmVyc2lvbmVkQXRvbVN0YXRlTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICAgIHZlcnNpb25lZEF0b21TdGF0ZU1hcE1hcC5zZXQodmVyc2lvbiwgdmVyc2lvbmVkQXRvbVN0YXRlTWFwKTtcbiAgICB9XG4gICAgcmV0dXJuIHZlcnNpb25lZEF0b21TdGF0ZU1hcDtcbiAgfTtcbiAgY29uc3QgZ2V0QXRvbVN0YXRlID0gKHZlcnNpb24sIGF0b20pID0+IHtcbiAgICBpZiAodmVyc2lvbikge1xuICAgICAgY29uc3QgdmVyc2lvbmVkQXRvbVN0YXRlTWFwID0gZ2V0VmVyc2lvbmVkQXRvbVN0YXRlTWFwKHZlcnNpb24pO1xuICAgICAgbGV0IGF0b21TdGF0ZSA9IHZlcnNpb25lZEF0b21TdGF0ZU1hcC5nZXQoYXRvbSk7XG4gICAgICBpZiAoIWF0b21TdGF0ZSkge1xuICAgICAgICBhdG9tU3RhdGUgPSBnZXRBdG9tU3RhdGUodmVyc2lvbi5wLCBhdG9tKTtcbiAgICAgICAgaWYgKGF0b21TdGF0ZSkge1xuICAgICAgICAgIGlmIChcInBcIiBpbiBhdG9tU3RhdGUpIHtcbiAgICAgICAgICAgIGF0b21TdGF0ZS5wLnRoZW4oKCkgPT4gdmVyc2lvbmVkQXRvbVN0YXRlTWFwLmRlbGV0ZShhdG9tKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZlcnNpb25lZEF0b21TdGF0ZU1hcC5zZXQoYXRvbSwgYXRvbVN0YXRlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGF0b21TdGF0ZTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbW1pdHRlZEF0b21TdGF0ZU1hcC5nZXQoYXRvbSk7XG4gIH07XG4gIGNvbnN0IHNldEF0b21TdGF0ZSA9ICh2ZXJzaW9uLCBhdG9tLCBhdG9tU3RhdGUpID0+IHtcbiAgICBpZiAoKGltcG9ydC5tZXRhLmVudiAmJiBpbXBvcnQubWV0YS5lbnYuTU9ERSkgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICBPYmplY3QuZnJlZXplKGF0b21TdGF0ZSk7XG4gICAgfVxuICAgIGlmICh2ZXJzaW9uKSB7XG4gICAgICBjb25zdCB2ZXJzaW9uZWRBdG9tU3RhdGVNYXAgPSBnZXRWZXJzaW9uZWRBdG9tU3RhdGVNYXAodmVyc2lvbik7XG4gICAgICB2ZXJzaW9uZWRBdG9tU3RhdGVNYXAuc2V0KGF0b20sIGF0b21TdGF0ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHByZXZBdG9tU3RhdGUgPSBjb21taXR0ZWRBdG9tU3RhdGVNYXAuZ2V0KGF0b20pO1xuICAgICAgY29tbWl0dGVkQXRvbVN0YXRlTWFwLnNldChhdG9tLCBhdG9tU3RhdGUpO1xuICAgICAgaWYgKCFwZW5kaW5nTWFwLmhhcyhhdG9tKSkge1xuICAgICAgICBwZW5kaW5nTWFwLnNldChhdG9tLCBwcmV2QXRvbVN0YXRlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIGNvbnN0IGNyZWF0ZVJlYWREZXBlbmRlbmNpZXMgPSAodmVyc2lvbiwgcHJldlJlYWREZXBlbmRlbmNpZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpLCBkZXBlbmRlbmNpZXMpID0+IHtcbiAgICBpZiAoIWRlcGVuZGVuY2llcykge1xuICAgICAgcmV0dXJuIHByZXZSZWFkRGVwZW5kZW5jaWVzO1xuICAgIH1cbiAgICBjb25zdCByZWFkRGVwZW5kZW5jaWVzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICBsZXQgY2hhbmdlZCA9IGZhbHNlO1xuICAgIGRlcGVuZGVuY2llcy5mb3JFYWNoKChhdG9tKSA9PiB7XG4gICAgICB2YXIgX2E7XG4gICAgICBjb25zdCByZXZpc2lvbiA9ICgoX2EgPSBnZXRBdG9tU3RhdGUodmVyc2lvbiwgYXRvbSkpID09IG51bGwgPyB2b2lkIDAgOiBfYS5yKSB8fCAwO1xuICAgICAgcmVhZERlcGVuZGVuY2llcy5zZXQoYXRvbSwgcmV2aXNpb24pO1xuICAgICAgaWYgKHByZXZSZWFkRGVwZW5kZW5jaWVzLmdldChhdG9tKSAhPT0gcmV2aXNpb24pIHtcbiAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKHByZXZSZWFkRGVwZW5kZW5jaWVzLnNpemUgPT09IHJlYWREZXBlbmRlbmNpZXMuc2l6ZSAmJiAhY2hhbmdlZCkge1xuICAgICAgcmV0dXJuIHByZXZSZWFkRGVwZW5kZW5jaWVzO1xuICAgIH1cbiAgICByZXR1cm4gcmVhZERlcGVuZGVuY2llcztcbiAgfTtcbiAgY29uc3Qgc2V0QXRvbVZhbHVlID0gKHZlcnNpb24sIGF0b20sIHZhbHVlLCBkZXBlbmRlbmNpZXMsIHN1c3BlbnNlUHJvbWlzZSkgPT4ge1xuICAgIGNvbnN0IGF0b21TdGF0ZSA9IGdldEF0b21TdGF0ZSh2ZXJzaW9uLCBhdG9tKTtcbiAgICBpZiAoYXRvbVN0YXRlKSB7XG4gICAgICBpZiAoc3VzcGVuc2VQcm9taXNlICYmICghKFwicFwiIGluIGF0b21TdGF0ZSkgfHwgIWlzRXF1YWxTdXNwZW5zZVByb21pc2UoYXRvbVN0YXRlLnAsIHN1c3BlbnNlUHJvbWlzZSkpKSB7XG4gICAgICAgIHJldHVybiBhdG9tU3RhdGU7XG4gICAgICB9XG4gICAgICBpZiAoXCJwXCIgaW4gYXRvbVN0YXRlKSB7XG4gICAgICAgIGNhbmNlbFN1c3BlbnNlUHJvbWlzZShhdG9tU3RhdGUucCk7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IG5leHRBdG9tU3RhdGUgPSB7XG4gICAgICB2OiB2YWx1ZSxcbiAgICAgIHI6IChhdG9tU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IGF0b21TdGF0ZS5yKSB8fCAwLFxuICAgICAgZDogY3JlYXRlUmVhZERlcGVuZGVuY2llcyh2ZXJzaW9uLCBhdG9tU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IGF0b21TdGF0ZS5kLCBkZXBlbmRlbmNpZXMpXG4gICAgfTtcbiAgICBpZiAoIWF0b21TdGF0ZSB8fCAhKFwidlwiIGluIGF0b21TdGF0ZSkgfHwgIU9iamVjdC5pcyhhdG9tU3RhdGUudiwgdmFsdWUpKSB7XG4gICAgICArK25leHRBdG9tU3RhdGUucjtcbiAgICAgIGlmIChuZXh0QXRvbVN0YXRlLmQuaGFzKGF0b20pKSB7XG4gICAgICAgIG5leHRBdG9tU3RhdGUuZCA9IG5ldyBNYXAobmV4dEF0b21TdGF0ZS5kKS5zZXQoYXRvbSwgbmV4dEF0b21TdGF0ZS5yKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKG5leHRBdG9tU3RhdGUuZCAhPT0gYXRvbVN0YXRlLmQgJiYgKG5leHRBdG9tU3RhdGUuZC5zaXplICE9PSBhdG9tU3RhdGUuZC5zaXplIHx8ICFBcnJheS5mcm9tKG5leHRBdG9tU3RhdGUuZC5rZXlzKCkpLmV2ZXJ5KChhKSA9PiBhdG9tU3RhdGUuZC5oYXMoYSkpKSkge1xuICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB7XG4gICAgICAgIGZsdXNoUGVuZGluZyh2ZXJzaW9uKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRBdG9tU3RhdGUodmVyc2lvbiwgYXRvbSwgbmV4dEF0b21TdGF0ZSk7XG4gICAgcmV0dXJuIG5leHRBdG9tU3RhdGU7XG4gIH07XG4gIGNvbnN0IHNldEF0b21SZWFkRXJyb3IgPSAodmVyc2lvbiwgYXRvbSwgZXJyb3IsIGRlcGVuZGVuY2llcywgc3VzcGVuc2VQcm9taXNlKSA9PiB7XG4gICAgY29uc3QgYXRvbVN0YXRlID0gZ2V0QXRvbVN0YXRlKHZlcnNpb24sIGF0b20pO1xuICAgIGlmIChhdG9tU3RhdGUpIHtcbiAgICAgIGlmIChzdXNwZW5zZVByb21pc2UgJiYgKCEoXCJwXCIgaW4gYXRvbVN0YXRlKSB8fCAhaXNFcXVhbFN1c3BlbnNlUHJvbWlzZShhdG9tU3RhdGUucCwgc3VzcGVuc2VQcm9taXNlKSkpIHtcbiAgICAgICAgcmV0dXJuIGF0b21TdGF0ZTtcbiAgICAgIH1cbiAgICAgIGlmIChcInBcIiBpbiBhdG9tU3RhdGUpIHtcbiAgICAgICAgY2FuY2VsU3VzcGVuc2VQcm9taXNlKGF0b21TdGF0ZS5wKTtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgbmV4dEF0b21TdGF0ZSA9IHtcbiAgICAgIGU6IGVycm9yLFxuICAgICAgcjogKGF0b21TdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogYXRvbVN0YXRlLnIpIHx8IDAsXG4gICAgICBkOiBjcmVhdGVSZWFkRGVwZW5kZW5jaWVzKHZlcnNpb24sIGF0b21TdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogYXRvbVN0YXRlLmQsIGRlcGVuZGVuY2llcylcbiAgICB9O1xuICAgIHNldEF0b21TdGF0ZSh2ZXJzaW9uLCBhdG9tLCBuZXh0QXRvbVN0YXRlKTtcbiAgICByZXR1cm4gbmV4dEF0b21TdGF0ZTtcbiAgfTtcbiAgY29uc3Qgc2V0QXRvbVN1c3BlbnNlUHJvbWlzZSA9ICh2ZXJzaW9uLCBhdG9tLCBzdXNwZW5zZVByb21pc2UsIGRlcGVuZGVuY2llcykgPT4ge1xuICAgIGNvbnN0IGF0b21TdGF0ZSA9IGdldEF0b21TdGF0ZSh2ZXJzaW9uLCBhdG9tKTtcbiAgICBpZiAoYXRvbVN0YXRlICYmIFwicFwiIGluIGF0b21TdGF0ZSkge1xuICAgICAgaWYgKGlzRXF1YWxTdXNwZW5zZVByb21pc2UoYXRvbVN0YXRlLnAsIHN1c3BlbnNlUHJvbWlzZSkpIHtcbiAgICAgICAgcmV0dXJuIGF0b21TdGF0ZTtcbiAgICAgIH1cbiAgICAgIGNhbmNlbFN1c3BlbnNlUHJvbWlzZShhdG9tU3RhdGUucCk7XG4gICAgfVxuICAgIGFkZFN1c3BlbnNlUHJvbWlzZVRvQ2FjaGUodmVyc2lvbiwgYXRvbSwgc3VzcGVuc2VQcm9taXNlKTtcbiAgICBjb25zdCBuZXh0QXRvbVN0YXRlID0ge1xuICAgICAgcDogc3VzcGVuc2VQcm9taXNlLFxuICAgICAgcjogKGF0b21TdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogYXRvbVN0YXRlLnIpIHx8IDAsXG4gICAgICBkOiBjcmVhdGVSZWFkRGVwZW5kZW5jaWVzKHZlcnNpb24sIGF0b21TdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogYXRvbVN0YXRlLmQsIGRlcGVuZGVuY2llcylcbiAgICB9O1xuICAgIHNldEF0b21TdGF0ZSh2ZXJzaW9uLCBhdG9tLCBuZXh0QXRvbVN0YXRlKTtcbiAgICByZXR1cm4gbmV4dEF0b21TdGF0ZTtcbiAgfTtcbiAgY29uc3Qgc2V0QXRvbVByb21pc2VPclZhbHVlID0gKHZlcnNpb24sIGF0b20sIHByb21pc2VPclZhbHVlLCBkZXBlbmRlbmNpZXMpID0+IHtcbiAgICBpZiAocHJvbWlzZU9yVmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICBjb25zdCBzdXNwZW5zZVByb21pc2UgPSBjcmVhdGVTdXNwZW5zZVByb21pc2UocHJvbWlzZU9yVmFsdWUudGhlbigodmFsdWUpID0+IHtcbiAgICAgICAgc2V0QXRvbVZhbHVlKHZlcnNpb24sIGF0b20sIHZhbHVlLCBkZXBlbmRlbmNpZXMsIHN1c3BlbnNlUHJvbWlzZSk7XG4gICAgICAgIGZsdXNoUGVuZGluZyh2ZXJzaW9uKTtcbiAgICAgIH0pLmNhdGNoKChlKSA9PiB7XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgIGlmIChpc1N1c3BlbnNlUHJvbWlzZShlKSkge1xuICAgICAgICAgICAgcmV0dXJuIGUudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgIHJlYWRBdG9tU3RhdGUodmVyc2lvbiwgYXRvbSwgdHJ1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGU7XG4gICAgICAgIH1cbiAgICAgICAgc2V0QXRvbVJlYWRFcnJvcih2ZXJzaW9uLCBhdG9tLCBlLCBkZXBlbmRlbmNpZXMsIHN1c3BlbnNlUHJvbWlzZSk7XG4gICAgICAgIGZsdXNoUGVuZGluZyh2ZXJzaW9uKTtcbiAgICAgIH0pKTtcbiAgICAgIHJldHVybiBzZXRBdG9tU3VzcGVuc2VQcm9taXNlKHZlcnNpb24sIGF0b20sIHN1c3BlbnNlUHJvbWlzZSwgZGVwZW5kZW5jaWVzKTtcbiAgICB9XG4gICAgcmV0dXJuIHNldEF0b21WYWx1ZSh2ZXJzaW9uLCBhdG9tLCBwcm9taXNlT3JWYWx1ZSwgZGVwZW5kZW5jaWVzKTtcbiAgfTtcbiAgY29uc3Qgc2V0QXRvbUludmFsaWRhdGVkID0gKHZlcnNpb24sIGF0b20pID0+IHtcbiAgICBjb25zdCBhdG9tU3RhdGUgPSBnZXRBdG9tU3RhdGUodmVyc2lvbiwgYXRvbSk7XG4gICAgaWYgKGF0b21TdGF0ZSkge1xuICAgICAgY29uc3QgbmV4dEF0b21TdGF0ZSA9IF9fc3ByZWFkUHJvcHMkMShfX3NwcmVhZFZhbHVlcyQxKHt9LCBhdG9tU3RhdGUpLCB7XG4gICAgICAgIGk6IGF0b21TdGF0ZS5yXG4gICAgICB9KTtcbiAgICAgIHNldEF0b21TdGF0ZSh2ZXJzaW9uLCBhdG9tLCBuZXh0QXRvbVN0YXRlKTtcbiAgICB9IGVsc2UgaWYgKChpbXBvcnQubWV0YS5lbnYgJiYgaW1wb3J0Lm1ldGEuZW52Lk1PREUpICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgY29uc29sZS53YXJuKFwiW0J1Z10gY291bGQgbm90IGludmFsaWRhdGUgbm9uIGV4aXN0aW5nIGF0b21cIiwgYXRvbSk7XG4gICAgfVxuICB9O1xuICBjb25zdCByZWFkQXRvbVN0YXRlID0gKHZlcnNpb24sIGF0b20sIGZvcmNlKSA9PiB7XG4gICAgaWYgKCFmb3JjZSkge1xuICAgICAgY29uc3QgYXRvbVN0YXRlID0gZ2V0QXRvbVN0YXRlKHZlcnNpb24sIGF0b20pO1xuICAgICAgaWYgKGF0b21TdGF0ZSkge1xuICAgICAgICBpZiAoYXRvbVN0YXRlLnIgIT09IGF0b21TdGF0ZS5pICYmIFwicFwiIGluIGF0b21TdGF0ZSAmJiAhaXNTdXNwZW5zZVByb21pc2VBbHJlYWR5Q2FuY2VsbGVkKGF0b21TdGF0ZS5wKSkge1xuICAgICAgICAgIHJldHVybiBhdG9tU3RhdGU7XG4gICAgICAgIH1cbiAgICAgICAgYXRvbVN0YXRlLmQuZm9yRWFjaCgoXywgYSkgPT4ge1xuICAgICAgICAgIGlmIChhICE9PSBhdG9tKSB7XG4gICAgICAgICAgICBpZiAoIW1vdW50ZWRNYXAuaGFzKGEpKSB7XG4gICAgICAgICAgICAgIHJlYWRBdG9tU3RhdGUodmVyc2lvbiwgYSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjb25zdCBhU3RhdGUgPSBnZXRBdG9tU3RhdGUodmVyc2lvbiwgYSk7XG4gICAgICAgICAgICAgIGlmIChhU3RhdGUgJiYgYVN0YXRlLnIgPT09IGFTdGF0ZS5pKSB7XG4gICAgICAgICAgICAgICAgcmVhZEF0b21TdGF0ZSh2ZXJzaW9uLCBhKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChBcnJheS5mcm9tKGF0b21TdGF0ZS5kKS5ldmVyeSgoW2EsIHJdKSA9PiB7XG4gICAgICAgICAgY29uc3QgYVN0YXRlID0gZ2V0QXRvbVN0YXRlKHZlcnNpb24sIGEpO1xuICAgICAgICAgIHJldHVybiBhU3RhdGUgJiYgXCJ2XCIgaW4gYVN0YXRlICYmIGFTdGF0ZS5yID09PSByO1xuICAgICAgICB9KSkge1xuICAgICAgICAgIHJldHVybiBhdG9tU3RhdGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgZGVwZW5kZW5jaWVzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvbWlzZU9yVmFsdWUgPSBhdG9tLnJlYWQoKGEpID0+IHtcbiAgICAgICAgZGVwZW5kZW5jaWVzLmFkZChhKTtcbiAgICAgICAgY29uc3QgYVN0YXRlID0gYSA9PT0gYXRvbSA/IGdldEF0b21TdGF0ZSh2ZXJzaW9uLCBhKSA6IHJlYWRBdG9tU3RhdGUodmVyc2lvbiwgYSk7XG4gICAgICAgIGlmIChhU3RhdGUpIHtcbiAgICAgICAgICBpZiAoXCJlXCIgaW4gYVN0YXRlKSB7XG4gICAgICAgICAgICB0aHJvdyBhU3RhdGUuZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKFwicFwiIGluIGFTdGF0ZSkge1xuICAgICAgICAgICAgdGhyb3cgYVN0YXRlLnA7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBhU3RhdGUudjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFzSW5pdGlhbFZhbHVlKGEpKSB7XG4gICAgICAgICAgcmV0dXJuIGEuaW5pdDtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJubyBhdG9tIGluaXRcIik7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBzZXRBdG9tUHJvbWlzZU9yVmFsdWUodmVyc2lvbiwgYXRvbSwgcHJvbWlzZU9yVmFsdWUsIGRlcGVuZGVuY2llcyk7XG4gICAgfSBjYXRjaCAoZXJyb3JPclByb21pc2UpIHtcbiAgICAgIGlmIChlcnJvck9yUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgY29uc3Qgc3VzcGVuc2VQcm9taXNlID0gY3JlYXRlU3VzcGVuc2VQcm9taXNlKGVycm9yT3JQcm9taXNlKTtcbiAgICAgICAgcmV0dXJuIHNldEF0b21TdXNwZW5zZVByb21pc2UodmVyc2lvbiwgYXRvbSwgc3VzcGVuc2VQcm9taXNlLCBkZXBlbmRlbmNpZXMpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNldEF0b21SZWFkRXJyb3IodmVyc2lvbiwgYXRvbSwgZXJyb3JPclByb21pc2UsIGRlcGVuZGVuY2llcyk7XG4gICAgfVxuICB9O1xuICBjb25zdCByZWFkQXRvbSA9IChyZWFkaW5nQXRvbSwgdmVyc2lvbikgPT4ge1xuICAgIGNvbnN0IGF0b21TdGF0ZSA9IHJlYWRBdG9tU3RhdGUodmVyc2lvbiwgcmVhZGluZ0F0b20pO1xuICAgIHJldHVybiBhdG9tU3RhdGU7XG4gIH07XG4gIGNvbnN0IGFkZEF0b20gPSAoYWRkaW5nQXRvbSkgPT4ge1xuICAgIGxldCBtb3VudGVkID0gbW91bnRlZE1hcC5nZXQoYWRkaW5nQXRvbSk7XG4gICAgaWYgKCFtb3VudGVkKSB7XG4gICAgICBtb3VudGVkID0gbW91bnRBdG9tKGFkZGluZ0F0b20pO1xuICAgIH1cbiAgICByZXR1cm4gbW91bnRlZDtcbiAgfTtcbiAgY29uc3QgY2FuVW5tb3VudEF0b20gPSAoYXRvbSwgbW91bnRlZCkgPT4gIW1vdW50ZWQubC5zaXplICYmICghbW91bnRlZC50LnNpemUgfHwgbW91bnRlZC50LnNpemUgPT09IDEgJiYgbW91bnRlZC50LmhhcyhhdG9tKSk7XG4gIGNvbnN0IGRlbEF0b20gPSAoZGVsZXRpbmdBdG9tKSA9PiB7XG4gICAgY29uc3QgbW91bnRlZCA9IG1vdW50ZWRNYXAuZ2V0KGRlbGV0aW5nQXRvbSk7XG4gICAgaWYgKG1vdW50ZWQgJiYgY2FuVW5tb3VudEF0b20oZGVsZXRpbmdBdG9tLCBtb3VudGVkKSkge1xuICAgICAgdW5tb3VudEF0b20oZGVsZXRpbmdBdG9tKTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IGludmFsaWRhdGVEZXBlbmRlbnRzID0gKHZlcnNpb24sIGF0b20pID0+IHtcbiAgICBjb25zdCBtb3VudGVkID0gbW91bnRlZE1hcC5nZXQoYXRvbSk7XG4gICAgbW91bnRlZCA9PSBudWxsID8gdm9pZCAwIDogbW91bnRlZC50LmZvckVhY2goKGRlcGVuZGVudCkgPT4ge1xuICAgICAgaWYgKGRlcGVuZGVudCAhPT0gYXRvbSkge1xuICAgICAgICBzZXRBdG9tSW52YWxpZGF0ZWQodmVyc2lvbiwgZGVwZW5kZW50KTtcbiAgICAgICAgaW52YWxpZGF0ZURlcGVuZGVudHModmVyc2lvbiwgZGVwZW5kZW50KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbiAgY29uc3Qgd3JpdGVBdG9tU3RhdGUgPSAodmVyc2lvbiwgYXRvbSwgdXBkYXRlKSA9PiB7XG4gICAgbGV0IGlzU3luYyA9IHRydWU7XG4gICAgY29uc3Qgd3JpdGVHZXR0ZXIgPSAoYSwgb3B0aW9ucykgPT4ge1xuICAgICAgY29uc3QgYVN0YXRlID0gcmVhZEF0b21TdGF0ZSh2ZXJzaW9uLCBhKTtcbiAgICAgIGlmIChcImVcIiBpbiBhU3RhdGUpIHtcbiAgICAgICAgdGhyb3cgYVN0YXRlLmU7XG4gICAgICB9XG4gICAgICBpZiAoXCJwXCIgaW4gYVN0YXRlKSB7XG4gICAgICAgIGlmIChvcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBvcHRpb25zLnVuc3RhYmxlX3Byb21pc2UpIHtcbiAgICAgICAgICByZXR1cm4gYVN0YXRlLnAudGhlbigoKSA9PiB3cml0ZUdldHRlcihhLCBvcHRpb25zKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChpbXBvcnQubWV0YS5lbnYgJiYgaW1wb3J0Lm1ldGEuZW52Lk1PREUpICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIlJlYWRpbmcgcGVuZGluZyBhdG9tIHN0YXRlIGluIHdyaXRlIG9wZXJhdGlvbi4gV2UgdGhyb3cgYSBwcm9taXNlIGZvciBub3cuXCIsIGEpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGFTdGF0ZS5wO1xuICAgICAgfVxuICAgICAgaWYgKFwidlwiIGluIGFTdGF0ZSkge1xuICAgICAgICByZXR1cm4gYVN0YXRlLnY7XG4gICAgICB9XG4gICAgICBpZiAoKGltcG9ydC5tZXRhLmVudiAmJiBpbXBvcnQubWV0YS5lbnYuTU9ERSkgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIltCdWddIG5vIHZhbHVlIGZvdW5kIHdoaWxlIHJlYWRpbmcgYXRvbSBpbiB3cml0ZSBvcGVyYXRpb24uIFRoaXMgaXMgcHJvYmFibHkgYSBidWcuXCIsIGEpO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwibm8gdmFsdWUgZm91bmRcIik7XG4gICAgfTtcbiAgICBjb25zdCBzZXR0ZXIgPSAoYSwgdikgPT4ge1xuICAgICAgbGV0IHByb21pc2VPclZvaWQyO1xuICAgICAgaWYgKGEgPT09IGF0b20pIHtcbiAgICAgICAgaWYgKCFoYXNJbml0aWFsVmFsdWUoYSkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJhdG9tIG5vdCB3cml0YWJsZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB2ZXJzaW9uU2V0ID0gY2FuY2VsQWxsU3VzcGVuc2VQcm9taXNlSW5DYWNoZShhKTtcbiAgICAgICAgdmVyc2lvblNldC5mb3JFYWNoKChjYW5jZWxsZWRWZXJzaW9uKSA9PiB7XG4gICAgICAgICAgaWYgKGNhbmNlbGxlZFZlcnNpb24gIT09IHZlcnNpb24pIHtcbiAgICAgICAgICAgIHNldEF0b21Qcm9taXNlT3JWYWx1ZShjYW5jZWxsZWRWZXJzaW9uLCBhLCB2KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBzZXRBdG9tUHJvbWlzZU9yVmFsdWUodmVyc2lvbiwgYSwgdik7XG4gICAgICAgIGludmFsaWRhdGVEZXBlbmRlbnRzKHZlcnNpb24sIGEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJvbWlzZU9yVm9pZDIgPSB3cml0ZUF0b21TdGF0ZSh2ZXJzaW9uLCBhLCB2KTtcbiAgICAgIH1cbiAgICAgIGlmICghaXNTeW5jKSB7XG4gICAgICAgIGZsdXNoUGVuZGluZyh2ZXJzaW9uKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwcm9taXNlT3JWb2lkMjtcbiAgICB9O1xuICAgIGNvbnN0IHByb21pc2VPclZvaWQgPSBhdG9tLndyaXRlKHdyaXRlR2V0dGVyLCBzZXR0ZXIsIHVwZGF0ZSk7XG4gICAgaXNTeW5jID0gZmFsc2U7XG4gICAgdmVyc2lvbiA9IHZvaWQgMDtcbiAgICByZXR1cm4gcHJvbWlzZU9yVm9pZDtcbiAgfTtcbiAgY29uc3Qgd3JpdGVBdG9tID0gKHdyaXRpbmdBdG9tLCB1cGRhdGUsIHZlcnNpb24pID0+IHtcbiAgICBjb25zdCBwcm9taXNlT3JWb2lkID0gd3JpdGVBdG9tU3RhdGUodmVyc2lvbiwgd3JpdGluZ0F0b20sIHVwZGF0ZSk7XG4gICAgZmx1c2hQZW5kaW5nKHZlcnNpb24pO1xuICAgIHJldHVybiBwcm9taXNlT3JWb2lkO1xuICB9O1xuICBjb25zdCBpc0FjdHVhbGx5V3JpdGFibGVBdG9tID0gKGF0b20pID0+ICEhYXRvbS53cml0ZTtcbiAgY29uc3QgbW91bnRBdG9tID0gKGF0b20sIGluaXRpYWxEZXBlbmRlbnQpID0+IHtcbiAgICBjb25zdCBtb3VudGVkID0ge1xuICAgICAgdDogbmV3IFNldChpbml0aWFsRGVwZW5kZW50ICYmIFtpbml0aWFsRGVwZW5kZW50XSksXG4gICAgICBsOiAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpXG4gICAgfTtcbiAgICBtb3VudGVkTWFwLnNldChhdG9tLCBtb3VudGVkKTtcbiAgICBpZiAoKGltcG9ydC5tZXRhLmVudiAmJiBpbXBvcnQubWV0YS5lbnYuTU9ERSkgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICBtb3VudGVkQXRvbXMuYWRkKGF0b20pO1xuICAgIH1cbiAgICBjb25zdCBhdG9tU3RhdGUgPSByZWFkQXRvbVN0YXRlKHZvaWQgMCwgYXRvbSk7XG4gICAgYXRvbVN0YXRlLmQuZm9yRWFjaCgoXywgYSkgPT4ge1xuICAgICAgY29uc3QgYU1vdW50ZWQgPSBtb3VudGVkTWFwLmdldChhKTtcbiAgICAgIGlmIChhTW91bnRlZCkge1xuICAgICAgICBhTW91bnRlZC50LmFkZChhdG9tKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChhICE9PSBhdG9tKSB7XG4gICAgICAgICAgbW91bnRBdG9tKGEsIGF0b20pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKGlzQWN0dWFsbHlXcml0YWJsZUF0b20oYXRvbSkgJiYgYXRvbS5vbk1vdW50KSB7XG4gICAgICBjb25zdCBzZXRBdG9tID0gKHVwZGF0ZSkgPT4gd3JpdGVBdG9tKGF0b20sIHVwZGF0ZSk7XG4gICAgICBjb25zdCBvblVubW91bnQgPSBhdG9tLm9uTW91bnQoc2V0QXRvbSk7XG4gICAgICBpZiAob25Vbm1vdW50KSB7XG4gICAgICAgIG1vdW50ZWQudSA9IG9uVW5tb3VudDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1vdW50ZWQ7XG4gIH07XG4gIGNvbnN0IHVubW91bnRBdG9tID0gKGF0b20pID0+IHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3Qgb25Vbm1vdW50ID0gKF9hID0gbW91bnRlZE1hcC5nZXQoYXRvbSkpID09IG51bGwgPyB2b2lkIDAgOiBfYS51O1xuICAgIGlmIChvblVubW91bnQpIHtcbiAgICAgIG9uVW5tb3VudCgpO1xuICAgIH1cbiAgICBtb3VudGVkTWFwLmRlbGV0ZShhdG9tKTtcbiAgICBpZiAoKGltcG9ydC5tZXRhLmVudiAmJiBpbXBvcnQubWV0YS5lbnYuTU9ERSkgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICBtb3VudGVkQXRvbXMuZGVsZXRlKGF0b20pO1xuICAgIH1cbiAgICBjb25zdCBhdG9tU3RhdGUgPSBnZXRBdG9tU3RhdGUodm9pZCAwLCBhdG9tKTtcbiAgICBpZiAoYXRvbVN0YXRlKSB7XG4gICAgICBhdG9tU3RhdGUuZC5mb3JFYWNoKChfLCBhKSA9PiB7XG4gICAgICAgIGlmIChhICE9PSBhdG9tKSB7XG4gICAgICAgICAgY29uc3QgbW91bnRlZCA9IG1vdW50ZWRNYXAuZ2V0KGEpO1xuICAgICAgICAgIGlmIChtb3VudGVkKSB7XG4gICAgICAgICAgICBtb3VudGVkLnQuZGVsZXRlKGF0b20pO1xuICAgICAgICAgICAgaWYgKGNhblVubW91bnRBdG9tKGEsIG1vdW50ZWQpKSB7XG4gICAgICAgICAgICAgIHVubW91bnRBdG9tKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmICgoaW1wb3J0Lm1ldGEuZW52ICYmIGltcG9ydC5tZXRhLmVudi5NT0RFKSAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgIGNvbnNvbGUud2FybihcIltCdWddIGNvdWxkIG5vdCBmaW5kIGF0b20gc3RhdGUgdG8gdW5tb3VudFwiLCBhdG9tKTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IG1vdW50RGVwZW5kZW5jaWVzID0gKGF0b20sIGF0b21TdGF0ZSwgcHJldlJlYWREZXBlbmRlbmNpZXMpID0+IHtcbiAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSBuZXcgU2V0KGF0b21TdGF0ZS5kLmtleXMoKSk7XG4gICAgcHJldlJlYWREZXBlbmRlbmNpZXMgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXZSZWFkRGVwZW5kZW5jaWVzLmZvckVhY2goKF8sIGEpID0+IHtcbiAgICAgIGlmIChkZXBlbmRlbmNpZXMuaGFzKGEpKSB7XG4gICAgICAgIGRlcGVuZGVuY2llcy5kZWxldGUoYSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG1vdW50ZWQgPSBtb3VudGVkTWFwLmdldChhKTtcbiAgICAgIGlmIChtb3VudGVkKSB7XG4gICAgICAgIG1vdW50ZWQudC5kZWxldGUoYXRvbSk7XG4gICAgICAgIGlmIChjYW5Vbm1vdW50QXRvbShhLCBtb3VudGVkKSkge1xuICAgICAgICAgIHVubW91bnRBdG9tKGEpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgZGVwZW5kZW5jaWVzLmZvckVhY2goKGEpID0+IHtcbiAgICAgIGNvbnN0IG1vdW50ZWQgPSBtb3VudGVkTWFwLmdldChhKTtcbiAgICAgIGlmIChtb3VudGVkKSB7XG4gICAgICAgIG1vdW50ZWQudC5hZGQoYXRvbSk7XG4gICAgICB9IGVsc2UgaWYgKG1vdW50ZWRNYXAuaGFzKGF0b20pKSB7XG4gICAgICAgIG1vdW50QXRvbShhLCBhdG9tKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgZmx1c2hQZW5kaW5nID0gKHZlcnNpb24pID0+IHtcbiAgICBpZiAodmVyc2lvbikge1xuICAgICAgY29uc3QgdmVyc2lvbmVkQXRvbVN0YXRlTWFwID0gZ2V0VmVyc2lvbmVkQXRvbVN0YXRlTWFwKHZlcnNpb24pO1xuICAgICAgdmVyc2lvbmVkQXRvbVN0YXRlTWFwLmZvckVhY2goKGF0b21TdGF0ZSwgYXRvbSkgPT4ge1xuICAgICAgICBpZiAoYXRvbVN0YXRlICE9PSBjb21taXR0ZWRBdG9tU3RhdGVNYXAuZ2V0KGF0b20pKSB7XG4gICAgICAgICAgY29uc3QgbW91bnRlZCA9IG1vdW50ZWRNYXAuZ2V0KGF0b20pO1xuICAgICAgICAgIG1vdW50ZWQgPT0gbnVsbCA/IHZvaWQgMCA6IG1vdW50ZWQubC5mb3JFYWNoKChsaXN0ZW5lcikgPT4gbGlzdGVuZXIodmVyc2lvbikpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgd2hpbGUgKHBlbmRpbmdNYXAuc2l6ZSkge1xuICAgICAgY29uc3QgcGVuZGluZyA9IEFycmF5LmZyb20ocGVuZGluZ01hcCk7XG4gICAgICBwZW5kaW5nTWFwLmNsZWFyKCk7XG4gICAgICBwZW5kaW5nLmZvckVhY2goKFthdG9tLCBwcmV2QXRvbVN0YXRlXSkgPT4ge1xuICAgICAgICBjb25zdCBhdG9tU3RhdGUgPSBnZXRBdG9tU3RhdGUodm9pZCAwLCBhdG9tKTtcbiAgICAgICAgaWYgKGF0b21TdGF0ZSAmJiBhdG9tU3RhdGUuZCAhPT0gKHByZXZBdG9tU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXZBdG9tU3RhdGUuZCkpIHtcbiAgICAgICAgICBtb3VudERlcGVuZGVuY2llcyhhdG9tLCBhdG9tU3RhdGUsIHByZXZBdG9tU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXZBdG9tU3RhdGUuZCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbW91bnRlZCA9IG1vdW50ZWRNYXAuZ2V0KGF0b20pO1xuICAgICAgICBtb3VudGVkID09IG51bGwgPyB2b2lkIDAgOiBtb3VudGVkLmwuZm9yRWFjaCgobGlzdGVuZXIpID0+IGxpc3RlbmVyKCkpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIGlmICgoaW1wb3J0Lm1ldGEuZW52ICYmIGltcG9ydC5tZXRhLmVudi5NT0RFKSAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgIHN0YXRlTGlzdGVuZXJzLmZvckVhY2goKGwpID0+IGwoKSk7XG4gICAgfVxuICB9O1xuICBjb25zdCBjb21taXRWZXJzaW9uZWRBdG9tU3RhdGVNYXAgPSAodmVyc2lvbikgPT4ge1xuICAgIGNvbnN0IHZlcnNpb25lZEF0b21TdGF0ZU1hcCA9IGdldFZlcnNpb25lZEF0b21TdGF0ZU1hcCh2ZXJzaW9uKTtcbiAgICB2ZXJzaW9uZWRBdG9tU3RhdGVNYXAuZm9yRWFjaCgoYXRvbVN0YXRlLCBhdG9tKSA9PiB7XG4gICAgICBjb25zdCBwcmV2QXRvbVN0YXRlID0gY29tbWl0dGVkQXRvbVN0YXRlTWFwLmdldChhdG9tKTtcbiAgICAgIGlmIChhdG9tU3RhdGUuciA+ICgocHJldkF0b21TdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogcHJldkF0b21TdGF0ZS5yKSB8fCAwKSB8fCBcInZcIiBpbiBhdG9tU3RhdGUgJiYgYXRvbVN0YXRlLnIgPT09IChwcmV2QXRvbVN0YXRlID09IG51bGwgPyB2b2lkIDAgOiBwcmV2QXRvbVN0YXRlLnIpICYmIGF0b21TdGF0ZS5kICE9PSAocHJldkF0b21TdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogcHJldkF0b21TdGF0ZS5kKSkge1xuICAgICAgICBjb21taXR0ZWRBdG9tU3RhdGVNYXAuc2V0KGF0b20sIGF0b21TdGF0ZSk7XG4gICAgICAgIGlmIChhdG9tU3RhdGUuZCAhPT0gKHByZXZBdG9tU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXZBdG9tU3RhdGUuZCkpIHtcbiAgICAgICAgICBtb3VudERlcGVuZGVuY2llcyhhdG9tLCBhdG9tU3RhdGUsIHByZXZBdG9tU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IHByZXZBdG9tU3RhdGUuZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgY29tbWl0QXRvbSA9IChfYXRvbSwgdmVyc2lvbikgPT4ge1xuICAgIGlmICh2ZXJzaW9uKSB7XG4gICAgICBjb21taXRWZXJzaW9uZWRBdG9tU3RhdGVNYXAodmVyc2lvbik7XG4gICAgfVxuICAgIGZsdXNoUGVuZGluZyh2b2lkIDApO1xuICB9O1xuICBjb25zdCBzdWJzY3JpYmVBdG9tID0gKGF0b20sIGNhbGxiYWNrKSA9PiB7XG4gICAgY29uc3QgbW91bnRlZCA9IGFkZEF0b20oYXRvbSk7XG4gICAgY29uc3QgbGlzdGVuZXJzID0gbW91bnRlZC5sO1xuICAgIGxpc3RlbmVycy5hZGQoY2FsbGJhY2spO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBsaXN0ZW5lcnMuZGVsZXRlKGNhbGxiYWNrKTtcbiAgICAgIGRlbEF0b20oYXRvbSk7XG4gICAgfTtcbiAgfTtcbiAgY29uc3QgcmVzdG9yZUF0b21zID0gKHZhbHVlcywgdmVyc2lvbikgPT4ge1xuICAgIGZvciAoY29uc3QgW2F0b20sIHZhbHVlXSBvZiB2YWx1ZXMpIHtcbiAgICAgIGlmIChoYXNJbml0aWFsVmFsdWUoYXRvbSkpIHtcbiAgICAgICAgc2V0QXRvbVByb21pc2VPclZhbHVlKHZlcnNpb24sIGF0b20sIHZhbHVlKTtcbiAgICAgICAgaW52YWxpZGF0ZURlcGVuZGVudHModmVyc2lvbiwgYXRvbSk7XG4gICAgICB9XG4gICAgfVxuICAgIGZsdXNoUGVuZGluZyh2ZXJzaW9uKTtcbiAgfTtcbiAgaWYgKChpbXBvcnQubWV0YS5lbnYgJiYgaW1wb3J0Lm1ldGEuZW52Lk1PREUpICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgIHJldHVybiB7XG4gICAgICBbUkVBRF9BVE9NXTogcmVhZEF0b20sXG4gICAgICBbV1JJVEVfQVRPTV06IHdyaXRlQXRvbSxcbiAgICAgIFtDT01NSVRfQVRPTV06IGNvbW1pdEF0b20sXG4gICAgICBbU1VCU0NSSUJFX0FUT01dOiBzdWJzY3JpYmVBdG9tLFxuICAgICAgW1JFU1RPUkVfQVRPTVNdOiByZXN0b3JlQXRvbXMsXG4gICAgICBbREVWX1NVQlNDUklCRV9TVEFURV06IChsKSA9PiB7XG4gICAgICAgIHN0YXRlTGlzdGVuZXJzLmFkZChsKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICBzdGF0ZUxpc3RlbmVycy5kZWxldGUobCk7XG4gICAgICAgIH07XG4gICAgICB9LFxuICAgICAgW0RFVl9HRVRfTU9VTlRFRF9BVE9NU106ICgpID0+IG1vdW50ZWRBdG9tcy52YWx1ZXMoKSxcbiAgICAgIFtERVZfR0VUX0FUT01fU1RBVEVdOiAoYSkgPT4gY29tbWl0dGVkQXRvbVN0YXRlTWFwLmdldChhKSxcbiAgICAgIFtERVZfR0VUX01PVU5URURdOiAoYSkgPT4gbW91bnRlZE1hcC5nZXQoYSlcbiAgICB9O1xuICB9XG4gIHJldHVybiB7XG4gICAgW1JFQURfQVRPTV06IHJlYWRBdG9tLFxuICAgIFtXUklURV9BVE9NXTogd3JpdGVBdG9tLFxuICAgIFtDT01NSVRfQVRPTV06IGNvbW1pdEF0b20sXG4gICAgW1NVQlNDUklCRV9BVE9NXTogc3Vic2NyaWJlQXRvbSxcbiAgICBbUkVTVE9SRV9BVE9NU106IHJlc3RvcmVBdG9tc1xuICB9O1xufTtcbmNvbnN0IGNyZWF0ZVN0b3JlRm9yRXhwb3J0ID0gKGluaXRpYWxWYWx1ZXMpID0+IHtcbiAgY29uc3Qgc3RvcmUgPSBjcmVhdGVTdG9yZShpbml0aWFsVmFsdWVzKTtcbiAgY29uc3QgZ2V0ID0gKGF0b20pID0+IHtcbiAgICBjb25zdCBhdG9tU3RhdGUgPSBzdG9yZVtSRUFEX0FUT01dKGF0b20pO1xuICAgIGlmIChcImVcIiBpbiBhdG9tU3RhdGUpIHtcbiAgICAgIHRocm93IGF0b21TdGF0ZS5lO1xuICAgIH1cbiAgICBpZiAoXCJwXCIgaW4gYXRvbVN0YXRlKSB7XG4gICAgICByZXR1cm4gdm9pZCAwO1xuICAgIH1cbiAgICByZXR1cm4gYXRvbVN0YXRlLnY7XG4gIH07XG4gIGNvbnN0IGFzeW5jR2V0ID0gKGF0b20pID0+IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBhdG9tU3RhdGUgPSBzdG9yZVtSRUFEX0FUT01dKGF0b20pO1xuICAgIGlmIChcImVcIiBpbiBhdG9tU3RhdGUpIHtcbiAgICAgIHJlamVjdChhdG9tU3RhdGUuZSk7XG4gICAgfSBlbHNlIGlmIChcInBcIiBpbiBhdG9tU3RhdGUpIHtcbiAgICAgIHJlc29sdmUoYXRvbVN0YXRlLnAudGhlbigoKSA9PiBhc3luY0dldChhdG9tKSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXNvbHZlKGF0b21TdGF0ZS52KTtcbiAgICB9XG4gIH0pO1xuICBjb25zdCBzZXQgPSAoYXRvbSwgdXBkYXRlKSA9PiBzdG9yZVtXUklURV9BVE9NXShhdG9tLCB1cGRhdGUpO1xuICBjb25zdCBzdWIgPSAoYXRvbSwgY2FsbGJhY2spID0+IHN0b3JlW1NVQlNDUklCRV9BVE9NXShhdG9tLCBjYWxsYmFjayk7XG4gIHJldHVybiB7XG4gICAgZ2V0LFxuICAgIGFzeW5jR2V0LFxuICAgIHNldCxcbiAgICBzdWIsXG4gICAgU0VDUkVUX0lOVEVSTkFMX3N0b3JlOiBzdG9yZVxuICB9O1xufTtcblxuY29uc3QgY3JlYXRlU2NvcGVDb250YWluZXIgPSAoaW5pdGlhbFZhbHVlcywgdW5zdGFibGVfY3JlYXRlU3RvcmUpID0+IHtcbiAgY29uc3Qgc3RvcmUgPSB1bnN0YWJsZV9jcmVhdGVTdG9yZSA/IHVuc3RhYmxlX2NyZWF0ZVN0b3JlKGluaXRpYWxWYWx1ZXMpLlNFQ1JFVF9JTlRFUk5BTF9zdG9yZSA6IGNyZWF0ZVN0b3JlKGluaXRpYWxWYWx1ZXMpO1xuICByZXR1cm4geyBzOiBzdG9yZSB9O1xufTtcbmNvbnN0IFNjb3BlQ29udGV4dE1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG5jb25zdCBnZXRTY29wZUNvbnRleHQgPSAoc2NvcGUpID0+IHtcbiAgaWYgKCFTY29wZUNvbnRleHRNYXAuaGFzKHNjb3BlKSkge1xuICAgIFNjb3BlQ29udGV4dE1hcC5zZXQoc2NvcGUsIGNyZWF0ZUNvbnRleHQoY3JlYXRlU2NvcGVDb250YWluZXIoKSkpO1xuICB9XG4gIHJldHVybiBTY29wZUNvbnRleHRNYXAuZ2V0KHNjb3BlKTtcbn07XG5cbnZhciBfX2RlZlByb3AgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG52YXIgX19kZWZQcm9wcyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzO1xudmFyIF9fZ2V0T3duUHJvcERlc2NzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM7XG52YXIgX19nZXRPd25Qcm9wU3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG52YXIgX19oYXNPd25Qcm9wID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbnZhciBfX3Byb3BJc0VudW0gPSBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xudmFyIF9fZGVmTm9ybWFsUHJvcCA9IChvYmosIGtleSwgdmFsdWUpID0+IGtleSBpbiBvYmogPyBfX2RlZlByb3Aob2JqLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSwgdmFsdWUgfSkgOiBvYmpba2V5XSA9IHZhbHVlO1xudmFyIF9fc3ByZWFkVmFsdWVzID0gKGEsIGIpID0+IHtcbiAgZm9yICh2YXIgcHJvcCBpbiBiIHx8IChiID0ge30pKVxuICAgIGlmIChfX2hhc093blByb3AuY2FsbChiLCBwcm9wKSlcbiAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTtcbiAgaWYgKF9fZ2V0T3duUHJvcFN5bWJvbHMpXG4gICAgZm9yICh2YXIgcHJvcCBvZiBfX2dldE93blByb3BTeW1ib2xzKGIpKSB7XG4gICAgICBpZiAoX19wcm9wSXNFbnVtLmNhbGwoYiwgcHJvcCkpXG4gICAgICAgIF9fZGVmTm9ybWFsUHJvcChhLCBwcm9wLCBiW3Byb3BdKTtcbiAgICB9XG4gIHJldHVybiBhO1xufTtcbnZhciBfX3NwcmVhZFByb3BzID0gKGEsIGIpID0+IF9fZGVmUHJvcHMoYSwgX19nZXRPd25Qcm9wRGVzY3MoYikpO1xuY29uc3QgUHJvdmlkZXIgPSAoe1xuICBjaGlsZHJlbixcbiAgaW5pdGlhbFZhbHVlcyxcbiAgc2NvcGUsXG4gIHVuc3RhYmxlX2NyZWF0ZVN0b3JlLFxuICB1bnN0YWJsZV9lbmFibGVWZXJzaW9uZWRXcml0ZVxufSkgPT4ge1xuICBjb25zdCBbdmVyc2lvbiwgc2V0VmVyc2lvbl0gPSB1c2VTdGF0ZSgpO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICh2ZXJzaW9uKSB7XG4gICAgICBzY29wZUNvbnRhaW5lclJlZi5jdXJyZW50LnNbQ09NTUlUX0FUT01dKG51bGwsIHZlcnNpb24pO1xuICAgICAgZGVsZXRlIHZlcnNpb24ucDtcbiAgICB9XG4gIH0sIFt2ZXJzaW9uXSk7XG4gIGNvbnN0IHNjb3BlQ29udGFpbmVyUmVmID0gdXNlUmVmKCk7XG4gIGlmICghc2NvcGVDb250YWluZXJSZWYuY3VycmVudCkge1xuICAgIHNjb3BlQ29udGFpbmVyUmVmLmN1cnJlbnQgPSBjcmVhdGVTY29wZUNvbnRhaW5lcihpbml0aWFsVmFsdWVzLCB1bnN0YWJsZV9jcmVhdGVTdG9yZSk7XG4gICAgaWYgKHVuc3RhYmxlX2VuYWJsZVZlcnNpb25lZFdyaXRlKSB7XG4gICAgICBzY29wZUNvbnRhaW5lclJlZi5jdXJyZW50LncgPSAod3JpdGUpID0+IHtcbiAgICAgICAgc2V0VmVyc2lvbigocGFyZW50VmVyc2lvbikgPT4ge1xuICAgICAgICAgIGNvbnN0IG5leHRWZXJzaW9uID0gcGFyZW50VmVyc2lvbiA/IHsgcDogcGFyZW50VmVyc2lvbiB9IDoge307XG4gICAgICAgICAgd3JpdGUobmV4dFZlcnNpb24pO1xuICAgICAgICAgIHJldHVybiBuZXh0VmVyc2lvbjtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBpZiAoKGltcG9ydC5tZXRhLmVudiAmJiBpbXBvcnQubWV0YS5lbnYuTU9ERSkgIT09IFwicHJvZHVjdGlvblwiICYmICh0eXBlb2YgcHJvY2VzcyAhPT0gXCJvYmplY3RcIiB8fCBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJ0ZXN0XCIpKSB7XG4gICAgdXNlRGVidWdTdGF0ZShzY29wZUNvbnRhaW5lclJlZi5jdXJyZW50KTtcbiAgfVxuICBjb25zdCBTY29wZUNvbnRhaW5lckNvbnRleHQgPSBnZXRTY29wZUNvbnRleHQoc2NvcGUpO1xuICByZXR1cm4gY3JlYXRlRWxlbWVudChTY29wZUNvbnRhaW5lckNvbnRleHQuUHJvdmlkZXIsIHtcbiAgICB2YWx1ZTogc2NvcGVDb250YWluZXJSZWYuY3VycmVudFxuICB9LCBjaGlsZHJlbik7XG59O1xuY29uc3QgYXRvbVRvUHJpbnRhYmxlID0gKGF0b20pID0+IGF0b20uZGVidWdMYWJlbCB8fCBhdG9tLnRvU3RyaW5nKCk7XG5jb25zdCBzdGF0ZVRvUHJpbnRhYmxlID0gKFtzdG9yZSwgYXRvbXNdKSA9PiBPYmplY3QuZnJvbUVudHJpZXMoYXRvbXMuZmxhdE1hcCgoYXRvbSkgPT4ge1xuICB2YXIgX2EsIF9iO1xuICBjb25zdCBtb3VudGVkID0gKF9hID0gc3RvcmVbREVWX0dFVF9NT1VOVEVEXSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNhbGwoc3RvcmUsIGF0b20pO1xuICBpZiAoIW1vdW50ZWQpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgY29uc3QgZGVwZW5kZW50cyA9IG1vdW50ZWQudDtcbiAgY29uc3QgYXRvbVN0YXRlID0gKChfYiA9IHN0b3JlW0RFVl9HRVRfQVRPTV9TVEFURV0pID09IG51bGwgPyB2b2lkIDAgOiBfYi5jYWxsKHN0b3JlLCBhdG9tKSkgfHwge307XG4gIHJldHVybiBbXG4gICAgW1xuICAgICAgYXRvbVRvUHJpbnRhYmxlKGF0b20pLFxuICAgICAgX19zcHJlYWRQcm9wcyhfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyhfX3NwcmVhZFZhbHVlcyh7fSwgXCJlXCIgaW4gYXRvbVN0YXRlICYmIHsgZXJyb3I6IGF0b21TdGF0ZS5lIH0pLCBcInBcIiBpbiBhdG9tU3RhdGUgJiYgeyBwcm9taXNlOiBhdG9tU3RhdGUucCB9KSwgXCJ2XCIgaW4gYXRvbVN0YXRlICYmIHsgdmFsdWU6IGF0b21TdGF0ZS52IH0pLCB7XG4gICAgICAgIGRlcGVuZGVudHM6IEFycmF5LmZyb20oZGVwZW5kZW50cykubWFwKGF0b21Ub1ByaW50YWJsZSlcbiAgICAgIH0pXG4gICAgXVxuICBdO1xufSkpO1xuY29uc3QgdXNlRGVidWdTdGF0ZSA9IChzY29wZUNvbnRhaW5lcikgPT4ge1xuICBjb25zdCB7IHM6IHN0b3JlIH0gPSBzY29wZUNvbnRhaW5lcjtcbiAgY29uc3QgW2F0b21zLCBzZXRBdG9tc10gPSB1c2VTdGF0ZShbXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IGNhbGxiYWNrID0gKCkgPT4ge1xuICAgICAgdmFyIF9hMjtcbiAgICAgIHNldEF0b21zKEFycmF5LmZyb20oKChfYTIgPSBzdG9yZVtERVZfR0VUX01PVU5URURfQVRPTVNdKSA9PSBudWxsID8gdm9pZCAwIDogX2EyLmNhbGwoc3RvcmUpKSB8fCBbXSkpO1xuICAgIH07XG4gICAgY29uc3QgdW5zdWJzY3JpYmUgPSAoX2EgPSBzdG9yZVtERVZfU1VCU0NSSUJFX1NUQVRFXSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNhbGwoc3RvcmUsIGNhbGxiYWNrKTtcbiAgICBjYWxsYmFjaygpO1xuICAgIHJldHVybiB1bnN1YnNjcmliZTtcbiAgfSwgW3N0b3JlXSk7XG4gIHVzZURlYnVnVmFsdWUoW3N0b3JlLCBhdG9tc10sIHN0YXRlVG9QcmludGFibGUpO1xufTtcblxubGV0IGtleUNvdW50ID0gMDtcbmZ1bmN0aW9uIGF0b20ocmVhZCwgd3JpdGUpIHtcbiAgY29uc3Qga2V5ID0gYGF0b20keysra2V5Q291bnR9YDtcbiAgY29uc3QgY29uZmlnID0ge1xuICAgIHRvU3RyaW5nOiAoKSA9PiBrZXlcbiAgfTtcbiAgaWYgKHR5cGVvZiByZWFkID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICBjb25maWcucmVhZCA9IHJlYWQ7XG4gIH0gZWxzZSB7XG4gICAgY29uZmlnLmluaXQgPSByZWFkO1xuICAgIGNvbmZpZy5yZWFkID0gKGdldCkgPT4gZ2V0KGNvbmZpZyk7XG4gICAgY29uZmlnLndyaXRlID0gKGdldCwgc2V0LCB1cGRhdGUpID0+IHNldChjb25maWcsIHR5cGVvZiB1cGRhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHVwZGF0ZShnZXQoY29uZmlnKSkgOiB1cGRhdGUpO1xuICB9XG4gIGlmICh3cml0ZSkge1xuICAgIGNvbmZpZy53cml0ZSA9IHdyaXRlO1xuICB9XG4gIHJldHVybiBjb25maWc7XG59XG5cbmZ1bmN0aW9uIHVzZUF0b21WYWx1ZShhdG9tLCBzY29wZSkge1xuICBjb25zdCBTY29wZUNvbnRleHQgPSBnZXRTY29wZUNvbnRleHQoc2NvcGUpO1xuICBjb25zdCB7IHM6IHN0b3JlIH0gPSB1c2VDb250ZXh0KFNjb3BlQ29udGV4dCk7XG4gIGNvbnN0IGdldEF0b21WYWx1ZSA9IHVzZUNhbGxiYWNrKCh2ZXJzaW9uMikgPT4ge1xuICAgIGNvbnN0IGF0b21TdGF0ZSA9IHN0b3JlW1JFQURfQVRPTV0oYXRvbSwgdmVyc2lvbjIpO1xuICAgIGlmIChcImVcIiBpbiBhdG9tU3RhdGUpIHtcbiAgICAgIHRocm93IGF0b21TdGF0ZS5lO1xuICAgIH1cbiAgICBpZiAoXCJwXCIgaW4gYXRvbVN0YXRlKSB7XG4gICAgICB0aHJvdyBhdG9tU3RhdGUucDtcbiAgICB9XG4gICAgaWYgKFwidlwiIGluIGF0b21TdGF0ZSkge1xuICAgICAgcmV0dXJuIGF0b21TdGF0ZS52O1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJubyBhdG9tIHZhbHVlXCIpO1xuICB9LCBbc3RvcmUsIGF0b21dKTtcbiAgY29uc3QgW1t2ZXJzaW9uLCB2YWx1ZSwgYXRvbUZyb21Vc2VSZWR1Y2VyXSwgcmVyZW5kZXJJZkNoYW5nZWRdID0gdXNlUmVkdWNlcih1c2VDYWxsYmFjaygocHJldiwgbmV4dFZlcnNpb24pID0+IHtcbiAgICBjb25zdCBuZXh0VmFsdWUgPSBnZXRBdG9tVmFsdWUobmV4dFZlcnNpb24pO1xuICAgIGlmIChPYmplY3QuaXMocHJldlsxXSwgbmV4dFZhbHVlKSAmJiBwcmV2WzJdID09PSBhdG9tKSB7XG4gICAgICByZXR1cm4gcHJldjtcbiAgICB9XG4gICAgcmV0dXJuIFtuZXh0VmVyc2lvbiwgbmV4dFZhbHVlLCBhdG9tXTtcbiAgfSwgW2dldEF0b21WYWx1ZSwgYXRvbV0pLCB2b2lkIDAsICgpID0+IHtcbiAgICBjb25zdCBpbml0aWFsVmVyc2lvbiA9IHZvaWQgMDtcbiAgICBjb25zdCBpbml0aWFsVmFsdWUgPSBnZXRBdG9tVmFsdWUoaW5pdGlhbFZlcnNpb24pO1xuICAgIHJldHVybiBbaW5pdGlhbFZlcnNpb24sIGluaXRpYWxWYWx1ZSwgYXRvbV07XG4gIH0pO1xuICBpZiAoYXRvbUZyb21Vc2VSZWR1Y2VyICE9PSBhdG9tKSB7XG4gICAgcmVyZW5kZXJJZkNoYW5nZWQodm9pZCAwKTtcbiAgfVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gc3RvcmVbU1VCU0NSSUJFX0FUT01dKGF0b20sIHJlcmVuZGVySWZDaGFuZ2VkKTtcbiAgICByZXJlbmRlcklmQ2hhbmdlZCh2b2lkIDApO1xuICAgIHJldHVybiB1bnN1YnNjcmliZTtcbiAgfSwgW3N0b3JlLCBhdG9tXSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgc3RvcmVbQ09NTUlUX0FUT01dKGF0b20sIHZlcnNpb24pO1xuICB9KTtcbiAgdXNlRGVidWdWYWx1ZSh2YWx1ZSk7XG4gIHJldHVybiB2YWx1ZTtcbn1cblxuZnVuY3Rpb24gdXNlU2V0QXRvbShhdG9tLCBzY29wZSkge1xuICBjb25zdCBTY29wZUNvbnRleHQgPSBnZXRTY29wZUNvbnRleHQoc2NvcGUpO1xuICBjb25zdCB7IHM6IHN0b3JlLCB3OiB2ZXJzaW9uZWRXcml0ZSB9ID0gdXNlQ29udGV4dChTY29wZUNvbnRleHQpO1xuICBjb25zdCBzZXRBdG9tID0gdXNlQ2FsbGJhY2soKHVwZGF0ZSkgPT4ge1xuICAgIGlmICghKFwid3JpdGVcIiBpbiBhdG9tKSAmJiB0eXBlb2YgcHJvY2VzcyA9PT0gXCJvYmplY3RcIiAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIm5vdCB3cml0YWJsZSBhdG9tXCIpO1xuICAgIH1cbiAgICBjb25zdCB3cml0ZSA9ICh2ZXJzaW9uKSA9PiBzdG9yZVtXUklURV9BVE9NXShhdG9tLCB1cGRhdGUsIHZlcnNpb24pO1xuICAgIHJldHVybiB2ZXJzaW9uZWRXcml0ZSA/IHZlcnNpb25lZFdyaXRlKHdyaXRlKSA6IHdyaXRlKCk7XG4gIH0sIFtzdG9yZSwgdmVyc2lvbmVkV3JpdGUsIGF0b21dKTtcbiAgcmV0dXJuIHNldEF0b207XG59XG5cbmZ1bmN0aW9uIHVzZUF0b20oYXRvbSwgc2NvcGUpIHtcbiAgaWYgKFwic2NvcGVcIiBpbiBhdG9tKSB7XG4gICAgY29uc29sZS53YXJuKFwiYXRvbS5zY29wZSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgZG8gdXNlQXRvbShhdG9tLCBzY29wZSkgaW5zdGVhZC5cIik7XG4gICAgc2NvcGUgPSBhdG9tLnNjb3BlO1xuICB9XG4gIHJldHVybiBbXG4gICAgdXNlQXRvbVZhbHVlKGF0b20sIHNjb3BlKSxcbiAgICB1c2VTZXRBdG9tKGF0b20sIHNjb3BlKVxuICBdO1xufVxuXG5leHBvcnQgeyBQcm92aWRlciwgZ2V0U2NvcGVDb250ZXh0IGFzIFNFQ1JFVF9JTlRFUk5BTF9nZXRTY29wZUNvbnRleHQsIGF0b20sIGNyZWF0ZVN0b3JlRm9yRXhwb3J0IGFzIHVuc3RhYmxlX2NyZWF0ZVN0b3JlLCB1c2VBdG9tLCB1c2VBdG9tVmFsdWUsIHVzZVNldEF0b20gfTtcbiJdLCJuYW1lcyI6WyJTVVNQRU5TRV9QUk9NSVNFIiwiU3ltYm9sIiwiaXNTdXNwZW5zZVByb21pc2UiLCJwcm9taXNlIiwiY2FuY2VsU3VzcGVuc2VQcm9taXNlIiwic3VzcGVuc2VQcm9taXNlIiwiX2EiLCJfYiIsImMiLCJjYWxsIiwiaXNFcXVhbFN1c3BlbnNlUHJvbWlzZSIsIm9sZFN1c3BlbnNlUHJvbWlzZSIsIm5ld1N1c3BlbnNlUHJvbWlzZSIsIm9sZE9yaWdpbmFsUHJvbWlzZSIsIm8iLCJuZXdPcmlnaW5hbFByb21pc2UiLCJjcmVhdGVTdXNwZW5zZVByb21pc2UiLCJvYmplY3RUb0F0dGFjaCIsIlByb21pc2UiLCJyZXNvbHZlIiwidGhlbiIsIl9fZGVmUHJvcCQxIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJfX2RlZlByb3BzJDEiLCJkZWZpbmVQcm9wZXJ0aWVzIiwiX19nZXRPd25Qcm9wRGVzY3MkMSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvcnMiLCJfX2dldE93blByb3BTeW1ib2xzJDEiLCJnZXRPd25Qcm9wZXJ0eVN5bWJvbHMiLCJfX2hhc093blByb3AkMSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiX19wcm9wSXNFbnVtJDEiLCJwcm9wZXJ0eUlzRW51bWVyYWJsZSIsIl9fZGVmTm9ybWFsUHJvcCQxIiwib2JqIiwia2V5IiwidmFsdWUiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJoYXNJbml0aWFsVmFsdWUiLCJhdG9tIiwiY3JlYXRlU3RvcmUiLCJpbml0aWFsVmFsdWVzIiwiY29tbWl0dGVkQXRvbVN0YXRlTWFwIiwiV2Vha01hcCIsIm1vdW50ZWRNYXAiLCJwZW5kaW5nTWFwIiwiTWFwIiwic3RhdGVMaXN0ZW5lcnMiLCJtb3VudGVkQXRvbXMiLCJTZXQiLCJhdG9tU3RhdGUiLCJ2IiwiciIsImQiLCJmcmVlemUiLCJjb25zb2xlIiwid2FybiIsInNldCIsInN1c3BlbnNlUHJvbWlzZUNhY2hlTWFwIiwidmVyc2lvbmVkQXRvbVN0YXRlTWFwTWFwIiwiZ2V0VmVyc2lvbmVkQXRvbVN0YXRlTWFwIiwidmVyc2lvbiIsInZlcnNpb25lZEF0b21TdGF0ZU1hcCIsImdldCIsImdldEF0b21TdGF0ZSIsInAiLCJkZWxldGUiLCJzZXRBdG9tU3RhdGUiLCJwcmV2QXRvbVN0YXRlIiwiaGFzIiwiY3JlYXRlUmVhZERlcGVuZGVuY2llcyIsInByZXZSZWFkRGVwZW5kZW5jaWVzIiwiZGVwZW5kZW5jaWVzIiwicmVhZERlcGVuZGVuY2llcyIsImNoYW5nZWQiLCJmb3JFYWNoIiwicmV2aXNpb24iLCJzaXplIiwic2V0QXRvbVZhbHVlIiwibmV4dEF0b21TdGF0ZSIsImlzIiwiQXJyYXkiLCJmcm9tIiwia2V5cyIsImV2ZXJ5IiwiYSIsImZsdXNoUGVuZGluZyIsInNldEF0b21SZWFkRXJyb3IiLCJlcnJvciIsImUiLCJzZXRBdG9tU3VzcGVuc2VQcm9taXNlIiwiY2FjaGUiLCJhZGRTdXNwZW5zZVByb21pc2VUb0NhY2hlIiwic2V0QXRvbVByb21pc2VPclZhbHVlIiwicHJvbWlzZU9yVmFsdWUiLCJjYXRjaCIsInJlYWRBdG9tU3RhdGUiLCJmb3JjZSIsImkiLCJfIiwiYVN0YXRlIiwicmVhZCIsImFkZCIsImluaXQiLCJFcnJvciIsImVycm9yT3JQcm9taXNlIiwiY2FuVW5tb3VudEF0b20iLCJtb3VudGVkIiwibCIsInQiLCJpbnZhbGlkYXRlRGVwZW5kZW50cyIsImRlcGVuZGVudCIsImIiLCJwcm9wIiwiX19zcHJlYWRWYWx1ZXMkMSIsInNldEF0b21JbnZhbGlkYXRlZCIsIndyaXRlQXRvbVN0YXRlIiwidXBkYXRlIiwiaXNTeW5jIiwid3JpdGVHZXR0ZXIiLCJvcHRpb25zIiwidW5zdGFibGVfcHJvbWlzZSIsImluZm8iLCJwcm9taXNlT3JWb2lkIiwid3JpdGUiLCJwcm9taXNlT3JWb2lkMiIsInZlcnNpb25TZXQiLCJjYW5jZWxBbGxTdXNwZW5zZVByb21pc2VJbkNhY2hlIiwiY2FuY2VsbGVkVmVyc2lvbiIsIndyaXRlQXRvbSIsIndyaXRpbmdBdG9tIiwibW91bnRBdG9tIiwiaW5pdGlhbERlcGVuZGVudCIsImFNb3VudGVkIiwiaXNBY3R1YWxseVdyaXRhYmxlQXRvbSIsIm9uTW91bnQiLCJzZXRBdG9tIiwib25Vbm1vdW50IiwidSIsInVubW91bnRBdG9tIiwibW91bnREZXBlbmRlbmNpZXMiLCJsaXN0ZW5lciIsInBlbmRpbmciLCJjbGVhciIsInJlYWRpbmdBdG9tIiwiX2F0b20iLCJjb21taXRWZXJzaW9uZWRBdG9tU3RhdGVNYXAiLCJjYWxsYmFjayIsImxpc3RlbmVycyIsImFkZGluZ0F0b20iLCJhZGRBdG9tIiwiZGVsZXRpbmdBdG9tIiwiZGVsQXRvbSIsInZhbHVlcyIsIlNjb3BlQ29udGV4dE1hcCIsImdldFNjb3BlQ29udGV4dCIsInNjb3BlIiwiY3JlYXRlQ29udGV4dCIsInMiLCJ1bnN0YWJsZV9jcmVhdGVTdG9yZSIsIlNFQ1JFVF9JTlRFUk5BTF9zdG9yZSIsImtleUNvdW50IiwiY29uZmlnIiwidG9TdHJpbmciLCJ1c2VBdG9tVmFsdWUiLCJTY29wZUNvbnRleHQiLCJzdG9yZSIsInVzZUNvbnRleHQiLCJnZXRBdG9tVmFsdWUiLCJ1c2VDYWxsYmFjayIsInZlcnNpb24yIiwiYXRvbUZyb21Vc2VSZWR1Y2VyIiwicmVyZW5kZXJJZkNoYW5nZWQiLCJ1c2VSZWR1Y2VyIiwicHJldiIsIm5leHRWZXJzaW9uIiwibmV4dFZhbHVlIiwiaW5pdGlhbFZlcnNpb24iLCJ1c2VFZmZlY3QiLCJ1bnN1YnNjcmliZSIsInVzZURlYnVnVmFsdWUiLCJ1c2VTZXRBdG9tIiwidyIsInZlcnNpb25lZFdyaXRlIiwidXNlQXRvbSJdLCJzb3VyY2VSb290IjoiIn0=